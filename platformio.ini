[env:esp32doit-devkit-v1]
platform = espressif32
board = esp32doit-devkit-v1
framework = arduino

; Build configuration - feature flags
build_flags = 
    -D SENSOR_READ_INTERVAL_MS=10000      ; Sensor read/log interval (ms)
    ; -D AUTO_BRIGHTNESS_ENABLED=1        ; Enable BH1750 auto-brightness (off by default)
    -D POWER_MONITORING_ENABLED=1         ; Enable INA219 power logging
    -D VERBOSE_LOGGING=1                ; Enable verbose debug logging

; Library dependencies - versions pinned where available
lib_deps = 
    robtillaart/RunningAverage @ 0.4.8
    me-no-dev/ESPAsyncWebServer
    me-no-dev/AsyncTCP
    alanswx/ESPAsyncWiFiManager @ 0.31
    fastled/FastLED @ 3.10.3
    ropg/ezTime @ 0.8.3
    claws/BH1750 @ 1.3.0
    adafruit/Adafruit BusIO @ 1.17.4
    adafruit/Adafruit INA219 @ 1.2.3
    igorantolic/Ai Esp32 Rotary Encoder @ 1.7.0

; Local library override (comment out and uncomment GitHub line for release)
lib_extra_dirs = tmp
; lib_deps += https://github.com/soliddifference/siebenuhr_core.git

; Serial monitor
monitor_speed = 115200
upload_speed = 460800
monitor_filters = direct

; ============================================================================
; Native test environment (runs on host, not ESP32)
; Run tests with: pio test -e native
; ============================================================================
[env:native]
platform = native
test_framework = unity
build_flags = 
    -std=c++17
    -DUNIT_TEST
    -I test/mocks
    -I src
build_src_filter =
    +<../test/mocks/>
    +<configuration.cpp>
lib_deps =
lib_ignore = 
    FastLED
    ESPAsyncWebServer
    AsyncTCP
    ESPAsyncWiFiManager
    ezTime
    BH1750
    Adafruit BusIO
    Adafruit INA219
    Ai Esp32 Rotary Encoder
    RunningAverage
    siebenuhr_core
